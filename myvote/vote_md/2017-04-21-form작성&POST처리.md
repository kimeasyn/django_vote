#### form 작성

```html
<!-- detail.html -->
<form action="{% url 'vote:vote' question.id %}" method="POST">
  {% csrf_token %}
  {% for choice in question.choice_set.all%}
    <input type="radio" name="choice" id="choice{{ forloop.count }}" value="{{ choice.id }}" />
    <!-- name = post의 dictionary처럼 쓸 수 있음 -->
    <label ofr="choice{{forloop.counter}}"> {{choice.choice_text}} </label><br>
  {% endfor %}
    <input type="submit" value="투표하기">
</form>
```

form object를 사용하지 않고 choice,question 두 객체를 사용해서 form 만듦



#### POST 처리

post로 처리할 vote page 만들기

```html
<!-- detail.html -->
<form action="{% url 'vote:vote' question.id %}" method="POST">
```

submit하면 vote:vote url로 post방식으로 보냄

vote:vote는 urls.py에서

```python
url(r'^(?P<question_id>[0-9]+)/vote/$', views.vote, name='vote'),
```

과 같이 views에 vote()로 리다이렉팅함

views.vote에서 post를 처리할 수 있게 수정



```python
#views.py
from django.shortcuts import render, get_object_or_404, redirect

def vote(request, question_id):
    question = get_object_or_404(Question, pk = question_id)
    try:
        selected_choice = question.choice_set.get(pk = request.POST['choice'])
        #input type = "submit"의 name의 value를 가지고 옴
    except:
        return render(request, 'vote/detail.html', {
            'question': question,
            'error_message': "You didn't select a choice."
        })
    else:
        selected_choice.votes += 1
        selected_choice.save()
        return redirect('vote:results', question_id = question.id )
```



